<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cannon Blast</title>
</head>
<script>
    //TODO
    //creare proiettili
    //sistemare movimento scrauso delle palle
    //creare movimento proiettili
    //fare in modo che non scappi l'immagine dal bordo
    //fare collisioni delle palle con il cannone
    //fare vettore con immagini per palle di colore diverso
    //muovi il cannone

    "use strict";
    let padre;
    function onload() {
        padre = document.getElementsByTagName("body")[0].querySelector("article");
    }
    let listaPalle = [];
    let timerCreaPalle;
    let timerMuoviPalle;
    let timerMuoviProiettili;
    let passo= 100; //quanto si muove il cannone
    let cannone = {x: 0, y:0};
    function startPartita() {
        timerCreaPalle = window.setInterval(creaPalle, 2000);
        timerMuoviPalle = window.setInterval(muoviPalle, 1);
        document.addEventListener("keydown", muoviCannone);
        // timerMuoviProiettili = window.setInterval(muoviProiettili, 1);
        let corpoCannone = document.createElement("img"); //crea il cannone
        corpoCannone.src = "Cannone.png";
        cannone.corpo = corpoCannone;
        //scrivere personalizzazione
        console.log(typeof (cannone.corpo));
        padre.appendChild(cannone.corpo);
    }
    //creare oggetto palla che ha boolean delle direzioni, le coordinate, la propria immagine e quantità di vita
    function muoviPalle() {
        
        for(let i = 0; i<listaPalle.length; i++){
            //muove la x(destra e sinistra) delle palle
            if(listaPalle[i].destra){
                listaPalle[i].x++;    
            } else {
                listaPalle[i].x--;
            }
            if(listaPalle[i].x>=window.innerWidth || listaPalle[i].x<=0){
                    listaPalle[i].destra=!listaPalle[i].destra;
                }
            //muove la y(su e giu) delle palle
            if(listaPalle[i].su){
                listaPalle[i].y--;
            } else {
                listaPalle[i].y++;
            }
            if(listaPalle[i].y>=window.innerHeight || listaPalle[i].y<=0){
                    listaPalle[i].su=!listaPalle[i].su;
                }
            // aggiunge i valori modificati negli oggetti alle proprietà css delle immagini
            listaPalle[i].corpo.style.left=listaPalle[i].x +"px";
            listaPalle[i].corpo.style.top=listaPalle[i].y +"px";

            console.log(typeof(listaPalle[i].corpo.style.left));
            console.log(listaPalle[i].x);

            // console.log(listaPalle[i].destra);
            // console.log(listaPalle[i].x);
            // console.log(listaPalle[i].su);
            // console.log(listaPalle[i].y);
        }
    }
    function creaPalle() {
        // window.clearInterval(timerCreaPalle);
        let palla={ destra: Math.random()>0.5 ? true : false,
                    su: false, //se la palla deve cadere oppure se rimbalza in su 
                    
                    y: 500, //all'inizio è uguale a yMax
                    yMax: 0, //fissa oppure che cambia ogni volta ma non cambia in game, massima altezza rimbalzo
                    immagine: "percorso dell'immagine", // forse non serve a un cazzo
                    vita: 500, 
                    corpo: document.createElement("img") }
                    //elementi che dipendono da altri vanno creati dopo
                    palla.x= palla.destra ? 0 : window.innerHeight, //o tutto sinistra o tutto destra, dipende dalla proprietà destra all'inizio
        // let palla = document.createElement("img");
        // console.log(Math.random()>0.5 ? true : false);
        palla.corpo.src = "Pallina.png";
        listaPalle.push(palla);
        padre.appendChild(palla.corpo);
    }
    // let listaCorpoPalle = [];
    // function creaPalle() {
    //     let palla = { sinistra: "boolean", x: 0, y: 0, immagine: "percorso dell'immagine", vita: 500, indicePalla: 0};
    //     let corpoPalla=document.createElement("img");
    //     corpoPalla.src="Pallina.png";
    //     listaPalle.push(palla);
    //     listaCorpoPalle.push(corpoPalla);
    //     padre.appendChild(corpoPalla);
    // }

    function muoviProiettili(){

    }
    
    function muoviCannone(event){
        switch (event.key) {
      case "ArrowLeft":
      case "A":
      case "a":
        cannone.x-=passo;
        break;
      case "ArrowRight":
      case "D":
      case "d":
      cannone.x+=passo;
        break;
        case "ArrowUp":
      case "W":
      case "w":
      cannone.x+=passo;
        break;
    }
    cannone.corpo.style.left = cannone.x +"px";
    }
</script>
<style>
    body {
        background-color: darkblue;
        margin: 0;
        height: 100vh;
        overflow: hidden;
        display: grid;
        grid-template-columns: 1fr 1fr 1fr 1fr 1fr;
        grid-template-rows: 7fr 1fr;
        grid-template-areas:
            "article article article article article"
            "footer footer footer footer footer";
    }

    article {
        grid-area: article;
        background-color: green;
    }

    footer {
        grid-area: footer;
        background-color: brown;
    }

    footer img {
        height: 239px;
        width: 20%;
        border-collapse: collapse;
    }
    article img{
        position: fixed;
    }
</style>
 <!-- modificare i nomi delle cose nel body -->
<body onload="onload()", onkeypress="muoviCannone()">
    <article>
        gay
    </article>
    <footer>
        <!-- <button> gay</button> -->
        <img src="Coez.PNG" onclick="startPartita()">
        <img src="Coez.PNG" onclick="startPartita()">
        <img src="Coez.PNG" onclick="startPartita()">
        <img src="Coez.PNG" onclick="startPartita()">
        <img src="Coez.PNG" onclick="startPartita()">
    </footer>

</body>

</html>